/* src/Stripe.svelte generated by Svelte v3.31.2 */
import {
	SvelteComponent,
	append,
	attr,
	detach,
	element,
	init,
	insert,
	listen,
	noop,
	safe_not_equal,
	space
} from "../web_modules/svelte/internal.js";

import { onMount } from "../web_modules/svelte.js";

function create_fragment(ctx) {
	let section;
	let div1;
	let t4;
	let button;
	let mounted;
	let dispose;

	return {
		c() {
			section = element("section");
			div1 = element("div");

			div1.innerHTML = `<img src="https://i.imgur.com/EHyR2nP.png" alt="The cover of Stubborn Attachments"/> 
        <div class="description"><h3>Stubborn Attachments</h3> 
            <h5>\$20.00</h5></div>`;

			t4 = space();
			button = element("button");
			button.textContent = "Checkout";
			attr(div1, "class", "product");
		},
		m(target, anchor) {
			insert(target, section, anchor);
			append(section, div1);
			append(section, t4);
			append(section, button);

			if (!mounted) {
				dispose = listen(button, "click", /*checkout*/ ctx[0]);
				mounted = true;
			}
		},
		p: noop,
		i: noop,
		o: noop,
		d(detaching) {
			if (detaching) detach(section);
			mounted = false;
			dispose();
		}
	};
}

function instance($$self) {
	let stripe;

	onMount(() => {
		stripe = Stripe("pk_test_51I7ulLHX1rk5bSX1NWKzYasE7DIcdINuZNebzwx6ywnMypYfnlVLR0pVg6MuTc8I3GuMmY4Fcymhhqhw2pcO3w8g00yko2X1T2");
	});

	function checkout() {
		fetch("http://localhost:8080/create/bounty", {
			method: "POST",
			headers: { "Content-Type": "application/json" },
			body: JSON.stringify({ amount: 3000, issue_id: 42 })
		}).then(function (response) {
			return response.json();
		}).then(function (session) {
			return stripe.redirectToCheckout({ sessionId: session.id });
		}).then(function (result) {
			// If redirectToCheckout fails due to a browser or network
			// error, you should display the localized error message to your
			// customer using error.message.
			if (result.error) {
				alert(result.error.message);
			}
		}).catch(function (error) {
			console.error("Error:", error);
		});
	}

	return [checkout];
}

class Stripe_1 extends SvelteComponent {
	constructor(options) {
		super();
		init(this, options, instance, create_fragment, safe_not_equal, {});
	}
}

export default Stripe_1;